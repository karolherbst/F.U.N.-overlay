--- /portage/trees/gentoo/games-action/supertuxkart/supertuxkart-0.6.2.ebuild	2010-11-03 10:07:34.000000000 +0100
+++ supertuxkart-0.7.ebuild	2010-12-23 16:40:36.000000000 +0100
@@ -3,7 +3,7 @@
 # $Header: /var/cvsroot/gentoo-x86/games-action/supertuxkart/supertuxkart-0.6.2.ebuild,v 1.9 2010/11/03 08:56:15 tupone Exp $
 
 EAPI=2
-inherit autotools eutils games
+inherit autotools flag-o-matic eutils games
 
 DESCRIPTION="A kart racing game starring Tux, the linux penguin (TuxKart fork)"
 HOMEPAGE="http://supertuxkart.sourceforge.net/"
@@ -12,24 +12,22 @@
 
 LICENSE="GPL-3 CCPL-Attribution-ShareAlike-3.0 CCPL-Attribution-2.0 CCPL-Sampling-Plus-1.0 public-domain as-is"
 SLOT="0"
-KEYWORDS="amd64 ~ppc x86"
-IUSE="nls"
+KEYWORDS="~amd64 ~ppc ~x86"
+IUSE="nls unicode"
 
-RDEPEND=">=media-libs/plib-1.8.4
+RDEPEND=">=dev-games/irrlicht-1.7.2
 	virtual/opengl
 	media-libs/freeglut
 	virtual/glu
 	net-libs/enet:0
-	media-libs/libmikmod
 	media-libs/libvorbis
 	media-libs/openal
-	media-libs/libsdl[X,video,audio,joystick]
 	virtual/libintl"
 DEPEND="${RDEPEND}
-	nls? ( sys-devel/gettext )"
+	nls? ( sys-devel/gettext )
+	unicode? ( dev-libs/fribidi )"
 
 src_prepare() {
-	esvn_clean
 	sed -i \
 		-e '/ENETTREE/d' \
 		-e '/src\/enet\/Makefile/d' \
@@ -52,17 +50,15 @@
 		-e '/AM_CPPFLAGS/s:/games::' \
 		src/Makefile.am \
 		|| die "sed failed"
-	# bug #328021
-	sed -i \
-		-e '13d' \
-		data/Makefile.am \
-		|| die "sed failed"
 	rm -rf src/enet
-	epatch "${FILESDIR}"/${P}-ovflfix.patch
 	eautoreconf
 }
 
 src_configure() {
+	append-libs -lpng
+	append-libs -ljpeg
+	append-libs -lbz2
+
 	egamesconf \
 		--disable-dependency-tracking \
 		$(use_enable nls)
