@@ -, +, @@ 
 handle two consecutive calls to ToUnicodeEx with both virtKeys mapped to
 dead-keys
---
 dlls/winex11.drv/keyboard.c | 21 ++++++++++++++++++---
 dlls/winex11.drv/x11drv.h   |  1 +
 2 files changed, 19 insertions(+), 3 deletions(-)
--- a/dlls/winex11.drv/keyboard.c	
+++ a/dlls/winex11.drv/keyboard.c	
@@ -2616,9 +2616,20 @@ INT CDECL X11DRV_ToUnicodeEx(UINT virtKey, UINT scanCode, const BYTE *lpKeyState
 	dead_char = KEYBOARD_MapDeadKeysym(keysym);
 	if (dead_char)
         {
-	    MultiByteToWideChar(CP_UNIXCP, 0, &dead_char, 1, bufW, bufW_size);
-	    ret = -1;
-            goto found;
+                if(x11drv_thread_data()->last_dead_key == 0)
+                {
+                        MultiByteToWideChar(CP_UNIXCP, 0, &dead_char, 1, bufW, bufW_size);
+                        x11drv_thread_data()->last_dead_key = dead_char;
+                        ret = -1;
+                        goto found;
+                }
+                else
+                {
+                        MultiByteToWideChar(CP_UNIXCP, 0, &x11drv_thread_data()->last_dead_key, 1, bufW, bufW_size);
+                        MultiByteToWideChar(CP_UNIXCP, 0, &dead_char, 1, bufW + 1, bufW_size - 1);
+                        ret = 2;
+                        goto found;
+                }
         }
 
         if (keysym >= 0x01000100 && keysym <= 0x0100ffff)
@@ -2709,6 +2720,10 @@ INT CDECL X11DRV_ToUnicodeEx(UINT virtKey, UINT scanCode, const BYTE *lpKeyState
     }
 
 found:
+    /* reset last dead key */
+    if (ret != -1)
+        x11drv_thread_data()->last_dead_key = 0;
+
     if (buf != lpChar)
         HeapFree(GetProcessHeap(), 0, lpChar);
 
--- a/dlls/winex11.drv/x11drv.h	
+++ a/dlls/winex11.drv/x11drv.h	
@@ -326,6 +326,7 @@ struct x11drv_thread_data
     void    *xi2_devices;          /* list of XInput2 devices (valid when state is enabled) */
     int      xi2_device_count;
     int      xi2_core_pointer;     /* XInput2 core pointer id */
+    char     last_dead_key;        /* last dead key from ToUnicodeEx */
 };
 
 extern struct x11drv_thread_data *x11drv_init_thread_data(void) DECLSPEC_HIDDEN;
-- 
